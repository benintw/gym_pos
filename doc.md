"""
env: gym_pos
"""

## 人臉辨識應用最新趨勢，5 大領域一次了解！【2024 最新版】

https://tw.cyberlink.com/faceme/insights/articles/236/how-to-use-facial-recognition

## 關於 Face8 台灣臉霸

https://face8.ai

## Aira

https://www.aira.com.tw/useCases/smartGym

## FaceMe

https://tw.cyberlink.com/faceme/insights/articles/208/Facial-Recognition-at-the-Edge-The-Ultimate-Guide

## 人臉辨識技術的主要功能：

1. 人臉偵測：
   偵測照片、影片中是否含有人臉，是人臉辨識的第一個步驟，同時也可以應用於照片及影片的管理、計算人數、偵測是否有人進出管制區域等。
2. 人臉比對與辨識：
   將人臉影像轉換成數位特徵值，進行比對並驗證其身分，是人臉辨識的基本功能，應用範圍也最為廣泛，如：刷臉登入 APP、門禁打卡、訪客登記、VIP 辨識、尋找失蹤人口等，都可以應用人臉辨識。
3. 活體辨識：
   辨識鏡頭前是否為真人，而非利用照片、影片、面具進行偽冒攻擊，防止身分被盜用，也是應用人臉辨識時重要的課題。
4. 臉部配件偵測：
   偵測人臉影像是否佩戴口罩、護目鏡、安全帽等配件，可以應用於工廠、工地、醫療院所、餐飲業廚房等場所，進行自動化安全管理。
5. 其他臉部資訊分析：
   根據人臉影像判斷其性別、年齡或情緒等資訊，可以進一步應用於精準行銷，或者有年齡限制場所的出入管制。

## 臉部偵測

臉部偵測為人臉辨識的第一步驟，透過深度學習電腦視覺演算法，將畫面中有包含人臉的區域精準框出。並標出人臉五官位置。

FaceMe® 的人臉偵測技術，即便僅局部的臉部出現於畫面之中，仍可於影像或影片中精準偵測及框列人臉位置。並可迅速於 5 毫秒內將同一畫面中的多張人臉全部偵測出來。

## 臉部特徵值擷取

此步驟由另一深度神經網路模型（簡稱：AI 模型）負責，將已框列出的臉部區域，轉換為一個高維空間中的向量數值，也就是所謂的人臉特徵值。因其為向量的特性，故可由計算兩向量之間的距離來得到兩個特徵值之間的相似度。此 AI 模型的任務就是將屬於同一人的特徵值，於空間值域中盡可能納入靠近的空間中，而不屬同一人的人臉則需要盡量區隔開來。AI 模型訓練過程中，透過極大量的訓練資料（千萬以上等級），還有 AI 模型中的超大數量的運算元（數億乃至數十億以上），以及特徵值的極高向量維度（1024 以上維度），讓 AI 模型得以於訓練過程中，自行學習如何準確的分析人臉部的特徵，藉以將人臉分類、分布於超高維度的空間之中。其訓練過程，往往需要幾百至幾千個 GPU 小時，且需要往復調整與最佳化諸多模型參數、訓練設定等。屬極端困難的工作任務。

## 比對與搜尋

經由計算兩個特徵值的相似度，並將該相似度與預先定義的閾值比較後，則可判定兩張人臉是否屬於同一人。在 eKYC 的情境中，人證比對是指比對證件上的人臉與鏡頭前的人臉是否屬於同一人，藉以完成驗證的過程，屬於 1:1 人臉比對的一種應用。

此外，如果將畫面中出現的人臉之特徵值與資料庫中預先登入的多個人臉特徵值進行搜尋，則為 1:N 人臉辨識。一般門禁、差勤系統的應用均屬此類。除了與將所有特徵值逐一比對的方法以外，FaceMe® 更進一步提供快速搜尋演算法，可以大幅減少所需比對次數，藉此大幅加速辨識速度。

比對與搜尋的過程中，只需要特徵值即可運作，因此可以避免需要將人臉影像儲存於資料庫中。此外，FaceMe® 進一步將特徵值以 AES-256 加密，更可確保資料的安全性與隱密性。

## 活體辨識及防偽

常見的人臉辨識破解方式包含使用臉部的照片或影片進行破解及身分冒用，也因此，活體辨識於人臉辨識應用至關重要。

什麼是活體辨識? 活體辨識指的是透過電腦視覺演算法，分辨被辨識者是否為真人，進而達到預防用戶身分被盜用的情形發生。

活體辨識及防偽可以有效阻擋照片或影片的身分冒用
活體辨識可依據相機模組的不同而分類如下：

1. 使用 2D 相機進行活體辨識

2D 相機（如：webcam 或一般手機前鏡頭）可透過互動或非互動方式進行活體辨識，互動方式係透過頭部指令（如：點頭、搖頭）或臉部表情（如：眨眼、張嘴）進行活體判別。而非互動方式係透過深度學習演算法，分析鏡頭前的人臉影像，藉光影變化、鏡頭移動時的幾何變化、皮下特徵、臉部細微動作等，進行真偽判別。因 2D 活體辨識不需要特殊的相機模組，導入成本較低也較容易普及，適合 eKYC 的使用情境。

在 2022 年 FaceMe® SDK 通過符合 ISO/IEC 30107-3 標準進行的 PAD（Presentation Attack Detection，活體冒用攻擊）測試，獲得 iBeta PAD Level 2 認證。爾後更於 2023 年美國國家標準與技術研究所（NIST）最新人臉分析技術評估（FATE，Face Analysis Technology Evaluation）的活體冒用攻擊檢測（PAD）中表現卓越，並且在以影片為輸入形式的便利性測試類別中，從全球 82 個人臉辨識演算法中脫穎而出，取得全球排名第一的佳績。

2. 使用 3D 景深相機進行活體辨識

當使用 3D 景深相機時，演算法可分析鏡頭前的人臉影像與深度圖，阻擋大部分的平面式攻擊，如：列印之人臉相片或透過螢幕播放人臉影片等。因此，3D 活體辨識相較 2D 活體辨識，更快速、直覺。然而，3D 相機所需成本也較高。FaceMe® 可支援的 3D 景深相機包括：Intel® RealSense™、iPad 及 iPhone 上的 3D 結構光相機、奇景光電（Himax）等。

3. 使用 IR+RGB 相機模組進行活體辨識

IR+RGB 相機模組為目前普遍於人臉辨識門禁、差勤機器、及微軟的 Windows Hello 所採用。IR+RGB 相機模組是指一個包含兩個光學鏡頭的相機模組，其中一個鏡頭接收可見光（RGB），另一個接收紅外線（IR）。因相紙、手機平版螢幕有著吸收或過濾紅外光線的特性，因此可有效阻止這一類的攻擊。IR+RGB 相機相較 3D 景深相機具很高的成本優勢，且可取得接近於 3D 景深的辨識速度與準確度，因此 IR+RGB 相機模組廣泛的被採用。
